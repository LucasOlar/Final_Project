empty[i,j] = f_0(x = X[i], y = Y[i])
}
}
plot <- plot_ly(x = X, y = Y, z = empty )
library(plotly)
size = 400
X = seq(from = -1.5, to = 1.5, length.out = size)
Y = X
empty <- matrix(0, size, size)
for (i in seq(1, size)){
for (j in seq(1, size)){
empty[i,j] = f_0(x = X[i], y = Y[i])
}
}
plot_ly(x = X, y = Y, z = empty )
library(plotly)
size = 400
X = seq(from = -1.5, to = 1.5, length.out = size)
Y = X
empty <- matrix(0, size, size)
for (i in seq(1, size)){
for (j in seq(1, size)){
empty[i,j] = f_0(x = X[i], y = Y[i])
}
}
plot_ly(x = X, y = Y, z = empty) %>% add_surface
View(empty)
library(quantmod)
all_stocks = c("AAPL", "AMZN", "DIS", "SHOP", "PINS", "NVDA", "F", "T", "TWTR", "BAC")
today = Sys.Date()
two_years_ago = seq(today, length = 2, by = "-2 year")[2]
getSymbols(all_stocks, from = two_years_ago, to = today)
library(quantmod)
all_stocks = c("AAPL", "AMZN", "DIS", "SHOP", "PINS", "NVDA", "F", "T", "TWTR", "BAC")
today = Sys.Date()
two_years_ago = seq(today, length = 2, by = "-2 year")[2]
getSymbols(all_stocks, from = two_years_ago, to = today)
install.packages("quantmod")
install.packages("quantmod")
library(quantmod)
all_stocks = c("AAPL", "AMZN", "DIS", "SHOP", "PINS", "NVDA", "F", "T", "TWTR", "BAC")
today = Sys.Date()
two_years_ago = seq(today, length = 2, by = "-2 year")[2]
getSymbols(all_stocks, from = two_years_ago, to = today)
View(AAPL)
?ClCl
AAPL_ret = na.omit(ClCl(AAPL))
AMZN_ret = na.omit(ClCl(AMZN))
sigma_mat = cov(cbind(AAPL_ret, AMZN_ret))
mu = c(mean(AAPL_ret), mean(AMZN_ret))
(omega_star = (sigma_mat[2, 2] - sigma_mat[1, 2])/(sigma_mat[1, 1] + sigma_mat[2, 2] - 2*sigma_mat[1, 2]))
length(all_stocks)
library(quantmod)
all_stocks = c("AAPL", "AMZN", "DIS", "SHOP", "PINS", "NVDA", "F", "T", "TWTR", "BAC")
today = Sys.Date()
two_years_ago = seq(today, length = 2, by = "-2 year")[2]
getSymbols(all_stocks, from = two_years_ago, to = today)
library(quantmod)
all_stocks = c("AAPL", "AMZN", "DIS", "SHOP", "PINS", "NVDA", "F", "T", "TWTR", "BAC")
today = Sys.Date()
two_years_ago = seq(today, length = 2, by = "-2 year")[2]
#getSymbols(all_stocks, from = two_years_ago, to = today)
for (i in seq(from = 1, to = length(all_stocks))){
for (j in seq(from = 1, to = length(all_stocks)))
AAPL_ret = na.omit(ClCl(i))
AMZN_ret = na.omit(ClCl(j))
sigma_mat = cov(cbind(AAPL_ret, AMZN_ret))
mu = c(mean(AAPL_ret), mean(AMZN_ret))
(omega_star = (sigma_mat[2, 2] - sigma_mat[1, 2])/(sigma_mat[1, 1] + sigma_mat[2, 2] - 2*sigma_mat[1, 2]))
(mu_investment = omega_star*mu[1] + (1 - omega_star)*mu[2])
(var_investment = omega_star^2*sigma_mat[1,1] + (1 - omega_star)^2*sigma_mat[2,2] + 2*omega_star*(1 - omega_star)*sigma_mat[1,2])
Z <- matrix(0, 3, 45)
z[j,i] = var_investment
}
library(quantmod)
all_stocks = c("AAPL", "AMZN", "DIS", "SHOP", "PINS", "NVDA", "F", "T", "TWTR", "BAC")
today = Sys.Date()
two_years_ago = seq(today, length = 2, by = "-2 year")[2]
#getSymbols(all_stocks, from = two_years_ago, to = today)
for (i in seq(from = 1, to = length(all_stocks))){
for (j in seq(from = 1, to = length(all_stocks))){
AAPL_ret = na.omit(ClCl(i))
AMZN_ret = na.omit(ClCl(j))
sigma_mat = cov(cbind(AAPL_ret, AMZN_ret))
mu = c(mean(AAPL_ret), mean(AMZN_ret))
(omega_star = (sigma_mat[2, 2] - sigma_mat[1, 2])/(sigma_mat[1, 1] + sigma_mat[2, 2] - 2*sigma_mat[1, 2]))
(mu_investment = omega_star*mu[1] + (1 - omega_star)*mu[2])
(var_investment = omega_star^2*sigma_mat[1,1] + (1 - omega_star)^2*sigma_mat[2,2] + 2*omega_star*(1 - omega_star)*sigma_mat[1,2])
Z <- matrix(0, 3, 45)
z[j,i] = var_investment
}
}
AAPL_ret = na.omit(ClCl(i))
for (i in seq(from = 1, to = length(all_stocks))){
for (j in seq(from = 1, to = length(all_stocks))){
AAPL_ret = na.omit(ClCl(all_stocks[i]))
AMZN_ret = na.omit(ClCl(all_stocks[j]))
sigma_mat = cov(cbind(AAPL_ret, AMZN_ret))
mu = c(mean(AAPL_ret), mean(AMZN_ret))
(omega_star = (sigma_mat[2, 2] - sigma_mat[1, 2])/(sigma_mat[1, 1] + sigma_mat[2, 2] - 2*sigma_mat[1, 2]))
(mu_investment = omega_star*mu[1] + (1 - omega_star)*mu[2])
(var_investment = omega_star^2*sigma_mat[1,1] + (1 - omega_star)^2*sigma_mat[2,2] + 2*omega_star*(1 - omega_star)*sigma_mat[1,2])
Z <- matrix(0, 3, 45)
z[j,i] = var_investment
}
}
library(quantmod)
all_stocks = c("AAPL", "AMZN", "DIS", "SHOP", "PINS", "NVDA", "F", "T", "TWTR", "BAC")
today = Sys.Date()
two_years_ago = seq(today, length = 2, by = "-2 year")[2]
#getSymbols(all_stocks, from = two_years_ago, to = today)
AAPL_ret = na.omit(ClCl(AAPL))
AMZN_ret = na.omit(ClCl(AMZN))
sigma_mat = cov(cbind(AAPL_ret, AMZN_ret))
mu = c(mean(AAPL_ret), mean(AMZN_ret))
(omega_star = (sigma_mat[2, 2] - sigma_mat[1, 2])/(sigma_mat[1, 1] + sigma_mat[2, 2] - 2*sigma_mat[1, 2]))
(mu_investment = omega_star*mu[1] + (1 - omega_star)*mu[2])
for (i in seq(from = 1, to = length(all_stocks))){
for (j in seq(from = 1, to = length(all_stocks))){
AAPL_ret = na.omit(ClCl(all_stocks[i]))
AMZN_ret = na.omit(ClCl(all_stocks[j]))
sigma_mat = cov(cbind(AAPL_ret, AMZN_ret))
mu = c(mean(AAPL_ret), mean(AMZN_ret))
omega_star = (sigma_mat[2, 2] - sigma_mat[1, 2])/(sigma_mat[1, 1] + sigma_mat[2, 2] - 2*sigma_mat[1, 2])
mu_investment = omega_star*mu[1] + (1 - omega_star)*mu[2])
for (i in seq(from = 1, to = length(all_stocks))){
for (j in seq(from = 1, to = length(all_stocks))){
AAPL_ret = na.omit(ClCl(all_stocks[i]))
AMZN_ret = na.omit(ClCl(all_stocks[j]))
sigma_mat = cov(cbind(AAPL_ret, AMZN_ret))
mu = c(mean(AAPL_ret), mean(AMZN_ret))
omega_star = (sigma_mat[2, 2] - sigma_mat[1, 2])/(sigma_mat[1, 1] + sigma_mat[2, 2] - 2*sigma_mat[1, 2])
mu_investment = omega_star*mu[1] + (1 - omega_star)*mu[2]
var_investment = omega_star^2*sigma_mat[1,1] + (1 - omega_star)^2*sigma_mat[2,2] + 2*omega_star*(1 - omega_star)*sigma_mat[1,2]
z <- matrix("", 3, 45)
z[j,i] = var_investment
}
}
for (i in seq(from = 1, to = length(all_stocks))){
for (j in seq(from = 1, to = length(all_stocks))){
AAPL_ret = na.omit(ClCl(get(all_stocks[i])))
AMZN_ret = na.omit(ClCl(get(all_stocks[j])))
sigma_mat = cov(cbind(AAPL_ret, AMZN_ret))
mu = c(mean(AAPL_ret), mean(AMZN_ret))
omega_star = (sigma_mat[2, 2] - sigma_mat[1, 2])/(sigma_mat[1, 1] + sigma_mat[2, 2] - 2*sigma_mat[1, 2])
mu_investment = omega_star*mu[1] + (1 - omega_star)*mu[2]
var_investment = omega_star^2*sigma_mat[1,1] + (1 - omega_star)^2*sigma_mat[2,2] + 2*omega_star*(1 - omega_star)*sigma_mat[1,2]
z <- matrix("", 3, 45)
z[j,i] = var_investment
}
}
library(quantmod)
all_stocks = c("AAPL", "AMZN", "DIS", "SHOP", "PINS", "NVDA", "F", "T", "TWTR", "BAC")
today = Sys.Date()
two_years_ago = seq(today, length = 2, by = "-2 year")[2]
#getSymbols(all_stocks, from = two_years_ago, to = today)
for (i in seq(from = 1, to = 10)){
for (j in seq(from = 1, to = 10)){
AAPL_ret = na.omit(ClCl(get(all_stocks[i])))
AMZN_ret = na.omit(ClCl(get(all_stocks[j])))
sigma_mat = cov(cbind(AAPL_ret, AMZN_ret))
mu = c(mean(AAPL_ret), mean(AMZN_ret))
omega_star = (sigma_mat[2, 2] - sigma_mat[1, 2])/(sigma_mat[1, 1] + sigma_mat[2, 2] - 2*sigma_mat[1, 2])
mu_investment = omega_star*mu[1] + (1 - omega_star)*mu[2]
var_investment = omega_star^2*sigma_mat[1,1] + (1 - omega_star)^2*sigma_mat[2,2] + 2*omega_star*(1 - omega_star)*sigma_mat[1,2]
z <- matrix("", 3, 45)
z[j,i] = var_investment
}
}
library(quantmod)
all_stocks = c("AAPL", "AMZN", "DIS", "SHOP", "PINS", "NVDA", "F", "T", "TWTR", "BAC")
today = Sys.Date()
two_years_ago = seq(today, length = 2, by = "-2 year")[2]
#getSymbols(all_stocks, from = two_years_ago, to = today)
for (i in seq(from = 1, to = 10)){
for (j in seq(from = 1, to = 10)){
AAPL_ret = na.omit(ClCl(get(all_stocks[i])))
AMZN_ret = na.omit(ClCl(get(all_stocks[j])))
sigma_mat = cov(cbind(AAPL_ret, AMZN_ret))
mu = c(mean(AAPL_ret), mean(AMZN_ret))
omega_star = (sigma_mat[2, 2] - sigma_mat[1, 2])/(sigma_mat[1, 1] + sigma_mat[2, 2] - 2*sigma_mat[1, 2])
mu_investment = omega_star*mu[1] + (1 - omega_star)*mu[2]
var_investment = omega_star^2*sigma_mat[1,1] + (1 - omega_star)^2*sigma_mat[2,2] + 2*omega_star*(1 - omega_star)*sigma_mat[1,2]
z <- matrix("", 3, 45)
z[j,i] = var_investment
}
}
all_stocks(1)
all_stocks[1]
for (i in seq(from = 1, to = 10)){
for (j in seq(from = i+1, to = 10)){
AAPL_ret = na.omit(ClCl(get(all_stocks[i])))
AMZN_ret = na.omit(ClCl(get(all_stocks[j])))
sigma_mat = cov(cbind(AAPL_ret, AMZN_ret))
mu = c(mean(AAPL_ret), mean(AMZN_ret))
omega_star = (sigma_mat[2, 2] - sigma_mat[1, 2])/(sigma_mat[1, 1] + sigma_mat[2, 2] - 2*sigma_mat[1, 2])
mu_investment = omega_star*mu[1] + (1 - omega_star)*mu[2]
var_investment = omega_star^2*sigma_mat[1,1] + (1 - omega_star)^2*sigma_mat[2,2] + 2*omega_star*(1 - omega_star)*sigma_mat[1,2]
z <- matrix("", 3, 45)
z[j,i] = var_investment
}
}
for (i in seq(from = 1, to = 10)){
for (j in seq(from = i+1, to = 10)){
AAPL_ret = na.omit(ClCl(get(all_stocks[i])))
AMZN_ret = na.omit(ClCl(get(all_stocks[j])))
sigma_mat = cov(cbind(AAPL_ret, AMZN_ret))
mu = c(mean(AAPL_ret), mean(AMZN_ret))
}}
library(quantmod)
all_stocks = c("AAPL", "AMZN", "DIS", "SHOP", "PINS", "NVDA", "F", "T", "TWTR", "BAC")
today = Sys.Date()
two_years_ago = seq(today, length = 2, by = "-2 year")[2]
getSymbols(all_stocks, from = two_years_ago, to = today)
for (i in seq(from = 1, to = 10)){
for (j in seq(from = i+1, to = 10)){
AAPL_ret = na.omit(ClCl(get(all_stocks[i])))
AMZN_ret = na.omit(ClCl(get(all_stocks[j])))
sigma_mat = cov(cbind(AAPL_ret, AMZN_ret))
mu = c(mean(AAPL_ret), mean(AMZN_ret))
omega_star = (sigma_mat[2, 2] - sigma_mat[1, 2])/(sigma_mat[1, 1] + sigma_mat[2, 2] - 2*sigma_mat[1, 2])
mu_investment = omega_star*mu[1] + (1 - omega_star)*mu[2]
var_investment = omega_star^2*sigma_mat[1,1] + (1 - omega_star)^2*sigma_mat[2,2] + 2*omega_star*(1 - omega_star)*sigma_mat[1,2]
z <- matrix("", 3, 45)
z[j,i] = var_investment
}
}
library(quantmod)
all_stocks = c("AAPL", "AMZN", "DIS", "SHOP", "PINS", "NVDA", "F", "T", "TWTR", "BAC")
today = Sys.Date()
two_years_ago = seq(today, length = 2, by = "-2 year")[2]
getSymbols(all_stocks, from = two_years_ago, to = today)
for (i in seq(from = 1, to = 10)){
for (j in seq(from = 1, to = 10)){
AAPL_ret = na.omit(ClCl(get(all_stocks[i])))
AMZN_ret = na.omit(ClCl(get(all_stocks[j])))
sigma_mat = cov(cbind(AAPL_ret, AMZN_ret))
mu = c(mean(AAPL_ret), mean(AMZN_ret))
omega_star = (sigma_mat[2, 2] - sigma_mat[1, 2])/(sigma_mat[1, 1] + sigma_mat[2, 2] - 2*sigma_mat[1, 2])
mu_investment = omega_star*mu[1] + (1 - omega_star)*mu[2]
var_investment = omega_star^2*sigma_mat[1,1] + (1 - omega_star)^2*sigma_mat[2,2] + 2*omega_star*(1 - omega_star)*sigma_mat[1,2]
z <- matrix("", 3, 45)
z[j,i] = var_investment
}
}
for (i in seq(from = 1, to = 10)){
for (j in seq(from = 1, to = 10)){
AAPL_ret = na.omit(ClCl(get(all_stocks[i])))
AMZN_ret = na.omit(ClCl(get(all_stocks[j])))
sigma_mat = cov(cbind(AAPL_ret, AMZN_ret))
mu = c(mean(AAPL_ret), mean(AMZN_ret))
omega_star = (sigma_mat[2, 2] - sigma_mat[1, 2])/(sigma_mat[1, 1] + sigma_mat[2, 2] - 2*sigma_mat[1, 2])
mu_investment = omega_star*mu[1] + (1 - omega_star)*mu[2]
var_investment = omega_star^2*sigma_mat[1,1] + (1 - omega_star)^2*sigma_mat[2,2] + 2*omega_star*(1 - omega_star)*sigma_mat[1,2]
z <- matrix("", 3, 45)
z[j,i] = var_investment
}
}
for (i in seq(from = 1, to = 10)){
for (j in seq(from = i+1, to = 10)){
AAPL_ret = na.omit(ClCl(get(all_stocks[i])))
AMZN_ret = na.omit(ClCl(get(all_stocks[j])))
sigma_mat = cov(cbind(AAPL_ret, AMZN_ret))
mu = c(mean(AAPL_ret), mean(AMZN_ret))
omega_star = (sigma_mat[2, 2] - sigma_mat[1, 2])/(sigma_mat[1, 1] + sigma_mat[2, 2] - 2*sigma_mat[1, 2])
mu_investment = omega_star*mu[1] + (1 - omega_star)*mu[2]
var_investment = omega_star^2*sigma_mat[1,1] + (1 - omega_star)^2*sigma_mat[2,2] + 2*omega_star*(1 - omega_star)*sigma_mat[1,2]
z <- matrix("", 45,3)
z[j,i] = var_investment
}
}
?rbinom
data = bacteria(30, 10^3, 1)
bacteria = function(initial, times, seed){
set.seed(seed)
bacteria_matrix = matrix(0,times,1)
bacteria_matrix[1,1] = initial
for(i in seq(from = 1, to = times)){
if(bacteria_matrix[i,1] > 15){
bacteria_matrix[i+1, 1] = bacteria_matrix[i,1] + 2*rbinom(n = 1,size = 1, prob = 0.5) - 1
} else {
bacteria_matrix[i+1, 1] = bacteria_matrix[i,1] + 2*rbinom(n = 1,size = 1, prob = 0.4) - 1
}
}
}
data = bacteria(30, 10^3, 1)
bacteria = function(initial, times, seed){
set.seed(seed)
bacteria_matrix = matrix(0,times,1)
bacteria_matrix[1,1] = initial
for(i in seq(from = 1, to = times)){
if(bacteria_matrix[i,1] > 15){
bacteria_matrix[i+1, 1] = bacteria_matrix[i,1] + 2*rbinom(n = 1,size = 1, prob = 0.5) - 1
} else {
bacteria_matrix[i+1, 1] = bacteria_matrix[i,1] + 2*rbinom(n = 1,size = 1, prob = 0.4) - 1
}
}
return(bacteria_matrix)
}
data = bacteria(30, 10^3, 1)
bacteria = function(initial, times, seed){
set.seed(seed)
bacteria_matrix = matrix(0,times+1,1)
bacteria_matrix[1,1] = initial
for(i in seq(from = 1, to = times)){
if(bacteria_matrix[i,1] > 15){
bacteria_matrix[i+1, 1] = bacteria_matrix[i,1] + 2*rbinom(n = 1,size = 1, prob = 0.5) - 1
} else {
bacteria_matrix[i+1, 1] = bacteria_matrix[i,1] + 2*rbinom(n = 1,size = 1, prob = 0.4) - 1
}
}
return(bacteria_matrix)
}
data = bacteria(30, 10^3, 1)
plot(data)
bacteria = function(initial, times, seed){
set.seed(seed)
bacteria_matrix = matrix(0,times+1,1)
bacteria_matrix[1,1] = initial
for(i in seq(from = 1, to = times)){
if(bacteria_matrix[i,1] <= 0){
bacteria_matrix[i+1, 1] = 0
}
if (bacteria_matrix[i,1]> 15 && bacteria_matrix[i,1] > 0){
bacteria_matrix[i+1, 1] = bacteria_matrix[i,1] + 2*rbinom(n = 1,size = 1, prob = 0.5) - 1
}
if(bacteria_matrix[i,1]<= 15 && bacteria_matrix[i,1] > 0){
bacteria_matrix[i+1, 1] = bacteria_matrix[i,1] + 2*rbinom(n = 1,size = 1, prob = 0.4) - 1
}
}
return(bacteria_matrix)
}
data = bacteria(30, 10^3, 1)
plot(data)
for (i in seq(from = 1, to = 10)){
for (j in seq(from = i+1, to = 10)){
AAPL_ret = na.omit(ClCl(get(all_stocks[i])))
AMZN_ret = na.omit(ClCl(get(all_stocks[j])))
sigma_mat = cov(cbind(AAPL_ret, AMZN_ret))
mu = c(mean(AAPL_ret), mean(AMZN_ret))
omega_star = (sigma_mat[2, 2] - sigma_mat[1, 2])/(sigma_mat[1, 1] + sigma_mat[2, 2] - 2*sigma_mat[1, 2])
mu_investment = omega_star*mu[1] + (1 - omega_star)*mu[2]
var_investment = omega_star^2*sigma_mat[1,1] + (1 - omega_star)^2*sigma_mat[2,2] + 2*omega_star*(1 - omega_star)*sigma_mat[1,2]
z <- matrix("", 45,3)
z[j,i] = var_investment
}
}
for (i in seq(from = 1, to = 10)){
for (j in seq(from = i+1, to = 10)){
AAPL_ret = na.omit(ClCl(get(all_stocks[i])))
AMZN_ret = na.omit(ClCl(get(all_stocks[j])))
sigma_mat = cov(cbind(AAPL_ret, AMZN_ret))
mu = c(mean(AAPL_ret), mean(AMZN_ret))
omega_star = (sigma_mat[2, 2] - sigma_mat[1, 2])/(sigma_mat[1, 1] + sigma_mat[2, 2] - 2*sigma_mat[1, 2])
mu_investment = omega_star*mu[1] + (1 - omega_star)*mu[2]
var_investment = omega_star^2*sigma_mat[1,1] + (1 - omega_star)^2*sigma_mat[2,2] + 2*omega_star*(1 - omega_star)*sigma_mat[1,2]
z <- matrix("", 45,1)
z[i,1] = var_investment
}
}
for (i in seq(from = 1, to = 10)){
for (j in seq(from = 1, to = 10)){
AAPL_ret = na.omit(ClCl(get(all_stocks[i])))
AMZN_ret = na.omit(ClCl(get(all_stocks[j])))
sigma_mat = cov(cbind(AAPL_ret, AMZN_ret))
mu = c(mean(AAPL_ret), mean(AMZN_ret))
omega_star = (sigma_mat[2, 2] - sigma_mat[1, 2])/(sigma_mat[1, 1] + sigma_mat[2, 2] - 2*sigma_mat[1, 2])
mu_investment = omega_star*mu[1] + (1 - omega_star)*mu[2]
var_investment = omega_star^2*sigma_mat[1,1] + (1 - omega_star)^2*sigma_mat[2,2] + 2*omega_star*(1 - omega_star)*sigma_mat[1,2]
z <- matrix("", 100,1)
z[i,1] = var_investment
}
}
min(z)
View(z)
for (i in seq(from = 1, to = 10)){
for (j in seq(from = i, to = 10)){
AAPL_ret = na.omit(ClCl(get(all_stocks[i])))
AMZN_ret = na.omit(ClCl(get(all_stocks[j])))
sigma_mat = cov(cbind(AAPL_ret, AMZN_ret))
mu = c(mean(AAPL_ret), mean(AMZN_ret))
omega_star = (sigma_mat[2, 2] - sigma_mat[1, 2])/(sigma_mat[1, 1] + sigma_mat[2, 2] - 2*sigma_mat[1, 2])
mu_investment = omega_star*mu[1] + (1 - omega_star)*mu[2]
var_investment = omega_star^2*sigma_mat[1,1] + (1 - omega_star)^2*sigma_mat[2,2] + 2*omega_star*(1 - omega_star)*sigma_mat[1,2]
z <- matrix("", )
z[i,1] = var_investment
}
}
library(shiny); runApp('MovieApp.R')
library(shiny); runApp('MovieApp.R')
url <- "https://raw.githubusercontent.com/rengalv/Movies-Data-Analysis-Grab-a-Popcorn/master/tmdb_5000_movies.csv"
# Reading the csv file from the URL
movies <- read_csv(url, col_names = TRUE, na = "NA")
movies <- movies[!duplicated(movies$title), ]
# Takes in the dataframe and column name to be transformed
json_to_df <- function(df, column) {
column_1 <- df[apply(df[, column], 1, nchar) > 2, ] # Checks if there is an entry
list_1 <- lapply(column_1[[column]], fromJSON) # Converts the JSON to a list
values <- data.frame(unlist(lapply(list_1, function(x) paste(x$name, collapse = ",")))) # Collapsing all the values of the list as a key value pair
final_df <- cbind(column_1$id, column_1$title, values) # new data frame with the key and values as columns
names(final_df) <- c("id", "title", column)
return(final_df)
}
genres_df <- json_to_df(movies, "genres")
keywords_df <- json_to_df(movies, "keywords")
prod_cntry_df <- json_to_df(movies, "production_countries")
prod_cmpny_df <- json_to_df(movies, "production_companies")
spoken_lang_df <- json_to_df(movies, "spoken_languages")
# Removing the JSON columns
movies_1 <- subset(movies, select = -c(genres, keywords, production_companies, production_countries, spoken_languages))
# Join the columns from all the generated dataframes from previous step
movies_df <- movies_1 %>%
full_join(genres_df, by = c("id", "title")) %>%
full_join(keywords_df, by = c("id", "title")) %>%
full_join(prod_cntry_df, by = c("id", "title")) %>%
full_join(prod_cmpny_df, by = c("id", "title")) %>%
full_join(spoken_lang_df, by = c("id", "title"))
View(prod_cntry_df)
?group_by
library(dyplr)
detach("package:dplyr", unload = TRUE)
library(dplyr)
library(dplyr)
countries <- prod_cntry_df %>%
group_by(production_countries)
View(countries)
countries <- group_by(prod_cntry_df, production_countries)
View(countries)
View(movies_1)
usadf <- df %>%
select(-1,-2,-3,-4,-7,-8,-9,-10,-11,-15) %>%
filter(grepl(pattern = "United States of America", x= production_countries))
usadf <- movies %>%
select(-1,-2,-3,-4,-7,-8,-9,-10,-11,-15) %>%
filter(grepl(pattern = "United States of America", x= production_countries))# %>%
# filter(grepl(pattern = "Romance", x= genres))
View(movies_df)
path <- "/Users/matteofabbri/moovies.csv"
library(readr)
movies <- read_csv("movies.csv")
View(movies)
dfgraph <- movies %<%
select(3,4,12)
library(dyplr)
library(dplyr)
dfgraph <- movies %<%
select(3,4,12)
dfgraph <- movies %>%
select(3,4,12)
dfgraph <- movies %>%
select(3,4,12)%>%
group_by(genre)
View(dfgraph)
dfgraph <- na.omit(movies) %>%
select(3,4,12)%>%
group_by(genre)
View(dfgraph)
dfgraph <- na.omit(movies) %>%
select(3,4,12)
View(dfgraph)
dfgraph <- na.omit(movies) %>%
select(3,4,12)%>%
group_by(genre,year)%>%
summarise(budget=sum(budget))
library(dplyr)
library(readr)
library(tidyr)
library(ggplot2)
graph1 = dfgraph%>%
ggplot(aes(x=year, y=budget, color = genre)) +
geom_line()
graph1 = dfgraph%>%
ggplot(aes(x=year, y=budget, color = genre)) +
geom_line()
View(graph1)
library(dplyr)
library(readr)
library(tidyr)
library(ggplot2)
fgraph <- na.omit(movies) %>%
select(3,4,12)%>%
group_by(genre,year)%>%
summarise(budget=sum(budget))
graph1 = dfgraph%>%
ggplot(aes(x=year, y=budget, color = genre)) +
geom_line()
graph1()
graph1
graph1.animation = graph1 +
transition_reveal(year) +
view_follow(fixed_y = TRUE)
gif1 <- animate(graph1.animation, height = 700, width = 900, fps = 60, duration = 15, end_pause = 60, res=100)
library(gganimate)
graph1.animation = graph1 +
transition_reveal(year) +
view_follow(fixed_y = TRUE)
gif1 <- animate(graph1.animation, height = 700, width = 900, fps = 60, duration = 15, end_pause = 60, res=100)
graph1.animation = graph1 +
transition_reveal(year) +
view_follow(fixed_y = TRUE)
gif1 <- animate(graph1.animation, height = 700, width = 900, fps = 20, duration = 15, end_pause = 60, res=100)
graph1
gif1
graph1
dfgraph <- na.omit(movies) %>%
select(3,4,11)%>%
group_by(country,year)%>%
summarise(budget=sum(budget))
dfgraph <- na.omit(movies) %>%
select(3,4,11)%>%
group_by(country,year)%>%
summarise(budget=mean(budget))
